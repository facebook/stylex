---
# Copyright (c) Meta Platforms, Inc. and affiliates.
#
# This source code is licensed under the MIT license found in the
# LICENSE file in the root directory of this source tree.
sidebar_position: 4
---

# React Router (RSC)

[`examples/example-react-router`](../../../../examples/example-react-router)
uses Vite’s experimental React Server Components plugin with StyleX compiled by
`@stylexjs/unplugin`. The StyleX plugin runs before the RSC plugin so both
client and server bundles share the same aggregated CSS.

## Vite configuration

```ts
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import rsc from '@react-router/dev/vite';
import stylex from '@stylexjs/unplugin';

export default defineConfig({
  plugins: [
    stylex.vite({ useCSSLayers: true }),
    react(),
    rsc(),
  ],
});
```

- Keep `stylex.vite()` first to preserve Fast Refresh.
- The root route imports `src/stylex.css` so Vite emits a CSS asset for the
  plugin to append to.

## Dev CSS/runtime injection

During dev the layout injects the virtual runtime and stylesheet so RSC updates
pick up style changes without reloads:

```tsx
{
  import.meta.env.DEV ? (
    <>
      <script type="module" src="/@id/virtual:stylex:runtime" />
      <link rel="stylesheet" href="/virtual:stylex.css" />
    </>
  ) : null;
}
```

If script tags are blocked, import the runtime from a client shim instead:

```ts
if (import.meta.env.DEV) import('virtual:stylex:runtime');
```

## Dev server gotcha

React Router exposes `__reactRouterDataRouter` for RSC. The example’s
`src/entry.browser.tsx` listens for `rsc:update` and revalidates either
`__router` or `__reactRouterDataRouter` to keep HMR working.

## Commands

- `npm run example:dev` — Vite dev server with RSC and live StyleX transforms.
- `npm run example:build` — production build with aggregated CSS.
- `npm run example:start` — run the Express server against the built output.
