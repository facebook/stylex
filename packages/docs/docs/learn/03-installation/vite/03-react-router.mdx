---
# Copyright (c) Meta Platforms, Inc. and affiliates.
#
# This source code is licensed under the MIT license found in the
# LICENSE file in the root directory of this source tree.
sidebar_position: 3
---

# React Router (RSC)

[`examples/example-react-router`](https://github.com/facebook/stylex/tree/main/examples/example-react-router)
uses Vite’s experimental React Server Components plugin with StyleX compiled by
`@stylexjs/unplugin`. The StyleX plugin runs before the RSC plugin so both
client and server bundles share the same aggregated CSS.

## Vite configuration

```ts
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import rsc from '@react-router/dev/vite';
import stylex from '@stylexjs/unplugin';

export default defineConfig({
  plugins: [
    stylex.vite({ useCSSLayers: true }),
    react(),
    rsc(),
  ],
});
```

- Keep `stylex.vite()` first to preserve Fast Refresh.
- The root route imports `src/stylex.css` so Vite emits a CSS asset for the
  plugin to append to.

## Dev CSS/runtime injection

Use a tiny helper to load the dev runtime + CSS link from a client component:

```tsx
// src/DevStyleXInject.tsx
'use client';
import { useEffect } from 'react';

function DevStyleXInjectImpl() {
  useEffect(() => {
    // @ts-ignore
    import('virtual:stylex:runtime');
  }, []);
  return <link rel="stylesheet" href="/virtual:stylex.css" />;
}

export const DevStyleXInject = import.meta.env.DEV
  ? DevStyleXInjectImpl
  : () => null;
```

Render `<DevStyleXInject />` in your root route/layout. The production CSS is
still loaded from the imported `src/stylex.css` asset.

```tsx
// src/routes/root/client.tsx (excerpt)
import { DevStyleXInject } from './DevStyleXInject';

export function Layout({ children }: { children: React.ReactNode }) {
  return (
    <html lang="en">
      <head>
        <DevStyleXInject />
      </head>
      <body>{children}</body>
    </html>
  );
}
```

## Dev server gotcha

React Router exposes `__reactRouterDataRouter` for RSC. The example’s
`src/entry.browser.tsx` listens for `rsc:update` and revalidates either
`__router` or `__reactRouterDataRouter` to keep HMR working.
