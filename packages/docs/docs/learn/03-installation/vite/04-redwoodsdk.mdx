---
# Copyright (c) Meta Platforms, Inc. and affiliates.
#
# This source code is licensed under the MIT license found in the
# LICENSE file in the root directory of this source tree.
sidebar_position: 4
---

# RedwoodSDK

[`examples/example-redwoodsdk`](https://github.com/facebook/stylex/tree/main/examples/example-redwoodsdk) shows
how RedwoodSDKâ€™s Vite-based toolchain works with `@stylexjs/unplugin`. StyleX
is compiled during both dev and build, and the aggregated CSS is appended to
the worker/client assets that Redwood emits.

## Vite configuration

```ts
// vite.config.mts
import { defineConfig } from 'vite';
import { redwood } from 'rwsdk/vite';
import { cloudflare } from '@cloudflare/vite-plugin';
import stylex from '@stylexjs/unplugin';

export default defineConfig({
  plugins: [
    cloudflare({ viteEnvironment: { name: 'worker' } }),
    redwood(),
    stylex.vite({
      devMode: 'css-only',
      devPersistToDisk: true,
      dev: true,
      runtimeInjection: false,
    }),
  ],
});
```

- `devMode: 'css-only'` exposes the `/virtual:stylex.css` endpoint without the
  JS runtime (Redwood owns HTML injection).
- `devPersistToDisk` shares collected rules across multiple Vite environments
  (worker + client).

## CSS entry and dev hooks

- Import `src/app/root.css` from the app shell so Vite always emits a CSS asset
  for StyleX to append to.
- Add a shared helper to load CSS in dev and prod:

  ```tsx
  // src/app/DevStyleXInject.tsx
  'use client';
  import { useEffect } from 'react';

  function DevStyleXInjectImpl() {
    useEffect(() => {
      if (import.meta.env.DEV) {
        import('virtual:stylex:css-only');
      }
    }, []);
    return <link rel="stylesheet" href="/virtual:stylex.css" />;
  }

  export function DevStyleXInject({ cssHref }: { cssHref: string }) {
    return import.meta.env.DEV ? (
      <DevStyleXInjectImpl />
    ) : (
      <link rel="stylesheet" href={cssHref} />
    );
  }
  ```

  Render `<DevStyleXInject cssHref="/client/assets/stylex.css" />` in your root
  layout/`Document`. The example worker/client build writes `stylex.css` to
  `/client/assets`, but adjust `cssHref` if your output path differs. The
  dev-only import keeps CSS HMR working while Redwood owns the HTML shell.

  ```tsx
  // src/app/Document.tsx (excerpt)
  import { DevStyleXInject } from './DevStyleXInject';

  export const Document = ({ children }: { children: React.ReactNode }) => (
    <html lang="en">
      <head>
        <DevStyleXInject cssHref="/client/assets/stylex.css" />
      </head>
      <body>
        <div id="root">{children}</div>
      </body>
    </html>
  );
  ```
